<div class="news-outer-wrapper">
    <div id="auto-news-feed" class="newspaper-grid">
        <p class="loading-text">üóûÔ∏è Syncing the Daily Edition...</p>
    </div>
</div>

<style>
    .news-outer-wrapper { display: flex; justify-content: center; width: 100%; padding: 40px 0; background: #f4f4f4; }
    .newspaper-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; max-width: 1200px; width: 95%; }
    .news-card { 
        flex: 1 1 350px; max-width: 450px; position: relative; padding: 25px; 
        background: #fff; border: 1px solid #dcdcdc; border-top: 5px solid #333;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05); overflow: hidden; transition: all 0.3s ease; 
    }
    .news-card:hover { transform: translateY(-8px); box-shadow: 0 15px 40px rgba(0,0,0,0.12); border-top-color: #2ea3f2; }
    .news-card h3 { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: #111; margin: 10px 0; line-height: 1.2; display: flex; align-items: flex-start; gap: 8px; }
    .news-card .summary { font-family: Georgia, serif; line-height: 1.7; color: #444; text-align: justify; }
    .read-more { display: inline-block; margin-top: 20px; font-weight: bold; color: #2ea3f2; text-decoration: none; border: 2px solid #2ea3f2; padding: 8px 20px; transition: 0.3s; }
    .read-more:hover { background: #2ea3f2; color: #fff; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const jsonUrl = 'https://raw.githubusercontent.com/KFruti88/clay-county-news/main/news_data.json';
    
    function getEmoji(item) {
        const text = (item.title + " " + (item.category || "") + " " + item.full_story).toLowerCase();
        if (text.includes("obituary") || text.includes("funeral")) return "üïäÔ∏è";
        if (text.includes("fire") || text.includes("smoke")) return "üöí";
        if (text.includes("police") || text.includes("sheriff") || text.includes("arrest")) return "üöî";
        if (text.includes("football")) return "üèà";
        if (text.includes("basketball")) return "üèÄ";
        if (text.includes("baseball")) return "‚öæ";
        if (text.includes("softball")) return "ü•é";
        if (text.includes("school") || text.includes("bus") || text.includes("student")) return "üöå";
        if (text.includes("church") || text.includes("pastor")) return "‚õ™";
        if (text.includes("hospital") || text.includes("medical")) return "üè•";
        if (text.includes("construction") || text.includes("road work")) return "üèóÔ∏è";
        if (text.includes("nasa") || text.includes("comet") || text.includes("meteor")) return "üî≠";
        if (text.includes("gas")) return "‚õΩ";
        if (text.includes("watermelon")) return "üçâ";
        if (text.includes("state news") || text.includes("illinois")) return "üèõÔ∏è";
        return "üì∞";
    }

    const currentUrl = window.location.href.toLowerCase();
    let town = "County News";
    if (currentUrl.includes('flora')) town = "Flora";
    else if (currentUrl.includes('louisville')) town = "Louisville";
    else if (currentUrl.includes('clay-city')) town = "Clay City";
    else if (currentUrl.includes('xenia')) town = "Xenia";
    else if (currentUrl.includes('sailor-springs')) town = "Sailor Springs";

    fetch(jsonUrl).then(res => res.json()).then(data => {
        const container = document.getElementById('auto-news-feed');
        container.innerHTML = '';
        const filtered = data.filter(item => item.tags && item.tags.includes(town));

        if(filtered.length === 0) {
            container.innerHTML = `<p>No recent local headlines for ${town}. Viewing General County News...</p>`;
            // Optionally show general news here
            return;
        }

        filtered.forEach(item => {
            const icon = getEmoji(item);
            const slug = item.slug || item.title.toLowerCase().replace(/[^\w\s-]/g, '').replace(/[\s_-]+/g, '-');
            const bookmarkLink = `https://supportmylocalcommunity.com/clay-county-news-center/#${slug}`;
            
            container.innerHTML += `
                <div class="news-card">
                    <div style="font-size:0.7rem; color:#999; text-transform:uppercase;">${town} Edition</div>
                    <h3><span>${icon}</span> ${item.title}</h3>
                    <div class="summary">${item.full_story.substring(0, 200)}...</div>
                    <a href="${bookmarkLink}" class="read-more">READ FULL STORY ‚Üí</a>
                </div>`;
        });
    });
});
</script>
