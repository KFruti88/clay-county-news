<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clay County News & Events Hub</title>
    <style>
        /* --- GLOBAL STYLING --- */
        body { margin: 0; background: #f4f4f4; font-family: 'Playfair Display', serif; color: #1a1a1a; }
        .master-wrapper { max-width: 1100px; margin: 0 auto; padding: 20px; }

        /* --- SMART HEADER (Date, Clock, Weather) --- */
        .custom-city-menu {
            width: 100%;
            background: #ffffff;
            padding: 15px 0;
            font-family: sans-serif;
            border-bottom: 2px solid #eee;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 10000;
        }
        .header-info {
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 12px;
            font-weight: bold;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            letter-spacing: 0.5px;
        }
        .live-dot { width: 8px; height: 8px; background: #ff0000; border-radius: 50%; animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
        
        #header-clock { color: #2ea3f2; display: flex; align-items: center; gap: 5px; }
        #header-weather { color: #fe4f00; }
        .divider { color: #ccc; }

        /* --- NAVIGATION LINKS --- */
        .city-nav {
            list-style: none;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 0;
            padding: 0;
        }
        .city-nav li a {
            text-decoration: none;
            color: #333;
            font-weight: bold;
            padding: 8px 15px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        /* Flora & Louisville Custom Buttons */
        .btn-flora a { background-color: #00205b !important; color: #fe4f00 !important; border-radius: 4px; }
        .btn-flora a:hover { background-color: #fe4f00 !important; color: #00205b !important; }
        .btn-louisville a { background-color: #060404 !important; color: #d61a21 !important; border-radius: 4px; }
        .btn-louisville a:hover { background-color: #d61a21 !important; color: #060404 !important; }

        /* --- CONTENT CARDS --- */
        .center-title { text-align: center; font-size: clamp(2rem, 8vw, 3rem); margin: 30px 0 20px; font-weight: 900; }
        .hub-tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .tab-btn { padding: 12px 25px; cursor: pointer; border: none; background: rgba(0,0,0,0.05); font-weight: bold; border-radius: 50px; transition: 0.3s; }
        .tab-btn.active { background: #2ea3f2; color: #fff; }

        .content-section { display: none; }
        .content-section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .glass-card { 
            background: white; padding: 30px; margin-bottom: 30px; border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.05); border-top: 8px solid #333;
        }
        .town-badge { display: inline-block; padding: 5px 12px; border-radius: 4px; color: #fff; font-size: 0.75rem; font-weight: bold; margin-bottom: 15px; text-transform: uppercase; }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .city-nav { flex-direction: column; gap: 10px; }
            .header-info { flex-direction: column; gap: 5px; }
            .divider { display: none; }
        }
    </style>
</head>
<body>

    <div class="custom-city-menu">
        <div class="header-info">
            <span id="header-date">Loading Date...</span>
            <span class="divider">|</span>
            <span id="header-clock"><div class="live-dot"></div> 00:00:00 PM</span>
            <span class="divider">|</span>
            <span id="header-weather">Flora Weather...</span>
        </div>
        <ul class="city-nav">
            <li><a href="https://supportmylocalcommunity.com/">Home</a></li>
            <li><a href="https://supportmylocalcommunity.com/clay-city/">Clay City</a></li>
            <li><a href="https://supportmylocalcommunity.com/xenia/">Xenia</a></li>
            <li class="btn-flora"><a href="https://ourflora.com/">Flora</a></li>
            <li class="btn-louisville"><a href="https://supportmylocalcommunity.com/louisville/">Louisville</a></li>
        </ul>
    </div>

    <div class="master-wrapper">
        <h1 class="center-title">Community News & Events</h1>

        <div class="hub-tabs">
            <button class="tab-btn active" onclick="showSection('news-archive', this)">üóûÔ∏è Latest News</button>
            <button class="tab-btn" onclick="showSection('calendar-archive', this)">üìÖ Events Calendar</button>
        </div>

        <div id="news-archive" class="content-section active">
            <div id="news-feed-container"><p style="text-align:center;">üóûÔ∏è Syncing Daily Edition...</p></div>
        </div>

        <div id="calendar-archive" class="content-section">
            <div id="calendar-feed-container"><p style="text-align:center;">üìÖ Loading Local Events...</p></div>
        </div>
    </div>

    <script>
        // --- 1. CLOCK & WEATHER ---
        function updateHeader() {
            const now = new Date();
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('header-date').innerText = now.toLocaleDateString('en-US', dateOptions);
            const timeStr = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            document.getElementById('header-clock').innerHTML = `<div class="live-dot"></div> ${timeStr}`;
        }
        setInterval(updateHeader, 1000);
        updateHeader();

        async function getWeather() {
            try {
                const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=38.67&longitude=-88.48&current_weather=true&temperature_unit=fahrenheit`);
                const data = await res.json();
                const weatherMap = { 0: "Sunny", 1: "Mainly Clear", 2: "Partly Cloudy", 3: "Overcast", 45: "Foggy", 61: "Rainy" };
                const desc = weatherMap[data.current_weather.weathercode] || "Cloudy";
                document.getElementById('header-weather').innerText = `${Math.round(data.current_weather.temperature)}¬∞F ‚Ä¢ ${desc}`;
            } catch (e) { document.getElementById('header-weather').innerText = "Weather Unavailable"; }
        }
        getWeather();
        setInterval(getWeather, 600000);

        // --- 2. DATA LOADERS ---
        const newsJson = './news_data.json';
        const calendarJson = 'https://raw.githubusercontent.com/KFruti88/Clay-County-All/main/Calendar/calendar_data.json';

        function getBranding(town) {
            const t = town ? town.toLowerCase() : "";
            if (t.includes('flora')) return { bg: '#0c0b82', accent: '#fe4f00', name: 'Flora' };
            if (t.includes('louisville')) return { bg: '#990000', accent: '#d61a21', name: 'Louisville' };
            return { bg: '#1a1a1a', accent: '#2ea3f2', name: 'Clay County' };
        }

        function showSection(id, btn) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        fetch(newsJson).then(res => res.json()).then(data => {
            const container = document.getElementById('news-feed-container');
            container.innerHTML = '';
            data.forEach(item => {
                const brand = getBranding(item.tags ? item.tags[0] : "");
                container.innerHTML += `
                    <div class="glass-card" style="border-top-color: ${brand.bg}">
                        <div class="town-badge" style="background:${brand.accent}">${brand.name}</div>
                        <h2>${item.title}</h2>
                        <div style="font-family: Georgia; line-height: 1.8;">${item.full_story}</div>
                    </div>`;
            });
        });

        fetch(calendarJson).then(res => res.json()).then(data => {
            const container = document.getElementById('calendar-feed-container');
            container.innerHTML = '';
            data.forEach(event => {
                const brand = getBranding(event.town);
                container.innerHTML += `
                    <div class="glass-card" style="border-top-color: ${brand.bg}">
                        <div class="town-badge" style="background:${brand.accent}">${event.town}</div>
                        <h3>${event.title}</h3>
                        <p>üìç ${event.location} | üïí ${event.time}</p>
                    </div>`;
            });
        });
    </script>
</body>
</html>
