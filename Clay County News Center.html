<div class="news-outer-wrapper">
    <div id="auto-news-feed" class="newspaper-grid">
        <p class="loading-text">üóûÔ∏è Syncing the Daily Edition...</p>
    </div>
</div>

<style>
    .news-outer-wrapper { display: flex; justify-content: center; width: 100%; padding: 40px 0; background: #f4f4f4; }
    .newspaper-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 30px; max-width: 1200px; width: 95%; }
    .news-card { 
        flex: 1 1 350px; max-width: 450px; position: relative; padding: 25px; 
        background: #fff; border: 1px solid #dcdcdc; border-top: 5px solid #333;
        box-shadow: 0 10px 30px rgba(0,0,0,0.05); overflow: hidden; transition: all 0.3s ease; 
    }
    .news-card:hover { transform: translateY(-8px); box-shadow: 0 15px 40px rgba(0,0,0,0.12); border-top-color: #2ea3f2; }
    .news-card h3 { font-family: 'Playfair Display', serif; font-size: 1.5rem; color: #111; margin: 10px 0; line-height: 1.2; display: flex; align-items: flex-start; gap: 8px; }
    .news-card .summary { font-family: Georgia, serif; line-height: 1.7; color: #444; text-align: justify; }
    .read-more { display: inline-block; margin-top: 20px; font-weight: bold; color: #2ea3f2; text-decoration: none; border: 2px solid #2ea3f2; padding: 8px 20px; transition: 0.3s; }
    .read-more:hover { background: #2ea3f2; color: #fff; }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const jsonUrl = 'https://raw.githubusercontent.com/KFruti88/clay-county-news/main/news_data.json';
    
    function getEmoji(item) {
        const text = (
            (item.title || "") + " " + 
            (item.category || "") + " " + 
            (item.full_story || "")
        ).toLowerCase();

        // --- EMERGENCY & WEATHER (Highest Priority) ---
        if (text.includes("tornado") || text.includes("warning") || text.includes("severe") || text.includes("siren")) return "‚ö†Ô∏è";
        if (text.includes("fire") || text.includes("smoke") || text.includes("blaze")) return "üöí";
        if (text.includes("police") || text.includes("sheriff") || text.includes("arrest") || text.includes("deputy") || text.includes("jail")) return "üöî";
        if (text.includes("storm") || text.includes("thunder") || text.includes("lightning")) return "‚õàÔ∏è";
        
        // --- OBITUARIES ---
        if (text.includes("obituary") || text.includes("funeral") || text.includes("passed away") || text.includes("visitation")) return "üïäÔ∏è";

        // --- FINANCIAL ---
        if (text.includes("tax") || text.includes("price") || text.includes("payment") || text.includes("cost") || text.includes("fee")) return "üí≤";
        if (text.includes("bill") || text.includes("spending") || text.includes("budget") || text.includes("funds")) return "üí∞";
        if (text.includes("gas price") || text.includes("gasoline") || text.includes("fuel") || text.includes("gas")) return "‚õΩ";

        // --- SPORTS ---
        if (text.includes("football")) return "üèà";
        if (text.includes("basketball")) return "üèÄ";
        if (text.includes("baseball")) return "‚öæ";
        if (text.includes("softball")) return "ü•é";
        if (text.includes("tennis")) return "üéæ";
        if (text.includes("golf")) return "üèåÔ∏è";

        // --- COMMUNITY & SCHOOLS ---
        if (text.includes("school") || text.includes("bus") || text.includes("student") || text.includes("teacher") || text.includes("graduation")) return "üöå";
        if (text.includes("church") || text.includes("pastor") || text.includes("worship") || text.includes("parish") || text.includes("sermon")) return "‚õ™";
        if (text.includes("hospital") || text.includes("medical") || text.includes("clinic") || text.includes("doctor") || text.includes("nurse")) return "üè•";
        if (text.includes("construction") || text.includes("road work") || text.includes("paving") || text.includes("bridge")) return "üèóÔ∏è";
        
        // --- SCIENCE & STATE ---
        if (text.includes("nasa") || text.includes("comet") || text.includes("star gazing") || text.includes("meteor")) return "üî≠";
        if (text.includes("state news") || text.includes("illinois") || text.includes("springfield")) return "üèõÔ∏è";

        // --- HOLIDAYS & EVENTS ---
        if (text.includes("veterans day") || text.includes("military")) return "üéñÔ∏è";
        if (text.includes("memorial day") || text.includes("remembrance")) return "üéóÔ∏è";
        if (text.includes("christmas") || text.includes("santa")) return "üéÑ";
        if (text.includes("thanksgiving") || text.includes("turkey")) return "ü¶É";
        if (text.includes("halloween") || text.includes("pumpkin")) return "üéÉ";
        if (text.includes("watermelon")) return "üçâ";
        if (text.includes("parade") || text.includes("festival") || text.includes("fair")) return "üé°";
        if (text.includes("vote") || text.includes("election") || text.includes("ballot")) return "üó≥Ô∏è";

        return "üì∞"; // The "Default" Newspaper Icon
    }

    const currentUrl = window.location.href.toLowerCase();
    let town = "County News";
    if (currentUrl.includes('flora')) town = "Flora";
    else if (currentUrl.includes('louisville')) town = "Louisville";
    else if (currentUrl.includes('clay-city')) town = "Clay City";
    else if (currentUrl.includes('xenia')) town = "Xenia";
    else if (currentUrl.includes('sailor-springs')) town = "Sailor Springs";

    fetch(jsonUrl).then(res => res.json()).then(data => {
        const container = document.getElementById('auto-news-feed');
        container.innerHTML = '';
        const filtered = data.filter(item => item.tags && item.tags.includes(town));

        if(filtered.length === 0) {
            container.innerHTML = `<p>No recent local headlines for ${town}. Viewing General County News...</p>`;
            return;
        }

        filtered.forEach(item => {
            const icon = getEmoji(item);
            const slug = item.slug || item.title.toLowerCase().replace(/[^\w\s-]/g, '').replace(/[\s
